<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>Lipscomb's Custom Remodeling – Home Renovations & Custom Builds</title>
 <!-- Google tag (gtag.js) – Update ID if needed for analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=GT-5DF6JG2M"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'GT-5DF6JG2M');
</script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
  <style>
    *{margin:0;padding:0;box-sizing:border-box;}
    :root {
      --primary-color:#8b4513;
      --secondary-color:#556b2f;
      --accent-color:#cd853f;
      --dark-color:#3c2f2f;
      --light-color:#f5f5dc;
      --text-color:#4d4d4d;
      --tile-border:#a0522d;
    }
    body{font-family:'Inter',sans-serif;color:var(--text-color);line-height:1.6;}
    .container{max-width:1200px;margin:0 auto;padding:0 20px;}
    
    /* Header - removed logo */
    header{background:linear-gradient(135deg,var(--primary-color),#a0522d);position:fixed;width:100%;top:0;z-index:1000;box-shadow:0 2px 10px rgba(0,0,0,0.2);}
    nav{display:flex;justify-content:space-between;align-items:center;padding:1rem 0;}
    .logo{color:#fff;font-size:1.8rem;font-weight:bold;display:flex;align-items:center;}
    .nav-links{display:flex;gap:2rem;list-style:none;margin-left:auto;}
    .nav-links a{color:#fff;text-decoration:none;font-weight:500;transition:color .3s;}
    .nav-links a:hover{color:var(--accent-color);}
    
    /* Tile-inspired buttons */
    .cta-button, .btn-primary, .btn-secondary{
      position:relative;
      padding:.7rem 1.5rem;
      border-radius:3px;
      font-weight:600;
      transition:all .3s;
      border:none;
      cursor:pointer;
      overflow:hidden;
      text-decoration:none;
      display:inline-block;
    }
    .cta-button, .btn-primary{
      background:linear-gradient(135deg, var(--accent-color) 0%, #b8733a 100%);
      color:#fff;
      box-shadow:inset 0 1px 0 rgba(255,255,255,0.3), 0 3px 8px rgba(0,0,0,0.2);
      border:2px solid var(--tile-border);
    }
    .cta-button::before, .btn-primary::before{
      content:'';
      position:absolute;
      top:0;
      left:-100%;
      width:100%;
      height:100%;
      background:linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
      transition:left 0.5s;
    }
    .cta-button:hover::before, .btn-primary:hover::before{left:100%;}
    .cta-button:hover, .btn-primary:hover{
      transform:translateY(-2px);
      box-shadow:inset 0 1px 0 rgba(255,255,255,0.4), 0 5px 12px rgba(0,0,0,0.3);
    }
    .btn-secondary{
      background:transparent;
      color:#fff;
      border:2px solid #fff;
      box-shadow:0 2px 6px rgba(0,0,0,0.15);
    }
    .btn-secondary:hover{
      background:rgba(255,255,255,0.1);
      border-color:var(--accent-color);
      transform:translateY(-2px);
    }
    
    .mobile-menu{display:none;font-size:1.5rem;color:#fff;cursor:pointer;}
    
    /* Section styling with borders */
    section{
      padding:80px 0;
      border-bottom:4px solid var(--tile-border);
      position:relative;
    }
    section::before{
      content:'';
      position:absolute;
      top:0;
      left:5%;
      right:5%;
      height:2px;
      background:linear-gradient(90deg, transparent, var(--accent-color), transparent);
    }
    
    .hero{
      background:linear-gradient(135deg,var(--primary-color),#a0522d);
      color:#fff;
      text-align:center;
      padding:140px 0 80px;
      border-bottom:6px solid var(--tile-border);
    }
    .hero::before{display:none;}
    .hero h1{font-size:2.8rem;margin-bottom:1rem;font-weight:800;text-shadow:2px 2px 4px rgba(0,0,0,0.3);}
    .hero p{font-size:1.2rem;margin-bottom:2rem;opacity:.9;}
    .hero-logo{
      display:block;
      max-width:400px;
      height:auto;
      margin:0 auto 2rem auto;
      filter:drop-shadow(0 4px 8px rgba(0,0,0,0.3));
    }
    .hero-buttons{display:flex;gap:1rem;justify-content:center;}
    
    .section-title{text-align:center;margin-bottom:3rem;}
    .section-title h2{
      font-size:2.5rem;
      color:var(--dark-color);
      margin-bottom:.5rem;
      position:relative;
      display:inline-block;
    }
    .section-title h2::after{
      content:'';
      position:absolute;
      bottom:-10px;
      left:50%;
      transform:translateX(-50%);
      width:60px;
      height:3px;
      background:var(--accent-color);
    }
    .section-title p{font-size:1rem;color:var(--text-color);opacity:.8;margin-top:1rem;}
    
    /* Gallery with description */
    .gallery-wrapper{
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:3rem;
      align-items:center;
      max-width:1100px;
      margin:0 auto;
      padding:2rem;
      background:var(--light-color);
      border:3px solid var(--tile-border);
      border-radius:8px;
      box-shadow:0 4px 15px rgba(0,0,0,0.1);
    }
    .gallery-container{
      position:relative;
      width:100%;
      max-width:550px;
    }
    .gallery-slide{
      display:none;
      text-align:center;
    }
    .gallery-slide.active{display:block;}
    .gallery-slide img{
      width:100%;
      height:400px;
      object-fit:cover;
      border-radius:8px;
      border:4px solid var(--tile-border);
      box-shadow:0 4px 12px rgba(0,0,0,0.2);
    }
    .gallery-description{
      padding:2rem;
      background:white;
      border:2px solid var(--tile-border);
      border-radius:8px;
      min-height:300px;
      display:flex;
      flex-direction:column;
      justify-content:center;
    }
    .gallery-description h3{
      color:var(--dark-color);
      font-size:1.8rem;
      margin-bottom:1rem;
    }
    .gallery-description p{
      color:var(--text-color);
      font-size:1.05rem;
      line-height:1.8;
    }
    .gallery-arrow{
      position:absolute;
      top:50%;
      transform:translateY(-50%);
      background:rgba(139,69,19,0.8);
      color:#fff;
      border:2px solid var(--tile-border);
      width:45px;
      height:45px;
      border-radius:50%;
      display:flex;
      align-items:center;
      justify-content:center;
      cursor:pointer;
      transition:all .3s;
      z-index:10;
      box-shadow:0 2px 8px rgba(0,0,0,0.3);
    }
    .gallery-arrow:hover{
      background:var(--accent-color);
      transform:translateY(-50%) scale(1.1);
    }
    .gallery-arrow.left{left:-20px;}
    .gallery-arrow.right{right:-20px;}
    
    /* Testimonials carousel */
    .testimonial-carousel{
      position:relative;
      max-width:1000px;
      margin:0 auto;
      padding:3rem 80px;
    }
    .testimonial-track{
      display:flex;
      align-items:center;
      justify-content:center;
      gap:1.5rem;
      position:relative;
      min-height:280px;
    }
    .testimonial{
      padding:2rem;
      background:var(--light-color);
      border:3px solid var(--tile-border);
      border-radius:10px;
      box-shadow:0 6px 20px rgba(0,0,0,0.15);
      transition:all .4s ease;
      flex-shrink:0;
      position:absolute;
    }
    .testimonial.center{
      width:500px;
      opacity:1;
      z-index:3;
      transform:scale(1) translateX(-50%);
      left:50%;
    }
    .testimonial.left{
      width:300px;
      opacity:0.5;
      z-index:1;
      transform:scale(0.85) translateX(-50%);
      left:15%;
      clip-path:inset(0 50% 0 0);
    }
    .testimonial.right{
      width:300px;
      opacity:0.5;
      z-index:1;
      transform:scale(0.85) translateX(-50%);
      left:85%;
      clip-path:inset(0 0 0 50%);
    }
    .stars{color:var(--accent-color);font-size:1.5rem;margin-bottom:1rem;}
    .testimonial-name{font-weight:600;font-size:1.2rem;margin-bottom:0.5rem;color:var(--dark-color);}
    .testimonial-desc{font-style:italic;font-size:1rem;color:var(--text-color);}
    .testimonial-arrow{
      position:absolute;
      top:50%;
      transform:translateY(-50%);
      background:rgba(139,69,19,0.9);
      color:#fff;
      border:2px solid var(--tile-border);
      width:50px;
      height:50px;
      border-radius:50%;
      display:flex;
      align-items:center;
      justify-content:center;
      cursor:pointer;
      transition:all .3s;
      z-index:10;
      box-shadow:0 3px 10px rgba(0,0,0,0.3);
    }
    .testimonial-arrow:hover{
      background:var(--accent-color);
      transform:translateY(-50%) scale(1.15);
    }
    .testimonial-arrow.left{left:0;}
    .testimonial-arrow.right{right:0;}
    
    .about-content{
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:3rem;
      align-items:center;
      padding:2rem;
      background:var(--light-color);
      border:3px solid var(--tile-border);
      border-radius:8px;
      box-shadow:0 4px 15px rgba(0,0,0,0.1);
    }
    .about-text h2{font-size:2rem;color:var(--dark-color);margin-bottom:1rem;}
    .about-text p{font-size:1rem;margin-bottom:1rem;}
    
    .contact-content{
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:3rem;
      padding:2rem;
      background:var(--light-color);
      border:3px solid var(--tile-border);
      border-radius:8px;
      box-shadow:0 4px 15px rgba(0,0,0,0.1);
    }
    .contact-info h2{font-size:2rem;color:var(--dark-color);margin-bottom:1rem;}
    .contact-item{display:flex;align-items:center;margin-bottom:1rem;}
    .contact-item i{
      width:40px;
      height:40px;
      background:linear-gradient(135deg, var(--primary-color), var(--accent-color));
      color:#fff;
      border:2px solid var(--tile-border);
      border-radius:50%;
      display:flex;
      align-items:center;
      justify-content:center;
      margin-right:.8rem;
      box-shadow:0 2px 6px rgba(0,0,0,0.2);
    }
    .contact-form{
      background:white;
      padding:2rem;
      border:2px solid var(--tile-border);
      border-radius:10px;
    }
    .form-group{margin-bottom:1rem;}
    .form-group label{display:block;margin-bottom:.5rem;font-weight:600;color:var(--dark-color);}
    .form-group input,.form-group textarea,.form-group select{
      width:100%;
      padding:.8rem;
      border:2px solid #d1d5db;
      border-radius:6px;
      transition:border-color .3s;
    }
    .form-group input:focus,.form-group textarea:focus,.form-group select:focus{
      outline:none;
      border-color:var(--accent-color);
    }
    .form-group textarea{height:120px;resize:vertical;}
    
    footer{background:var(--dark-color);color:#fff;padding:2rem 0;border-top:4px solid var(--tile-border);}
    .footer-content{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:2rem;margin-bottom:1rem;}
    .footer-section h3{color:var(--accent-color);margin-bottom:.5rem;}
    .footer-section p,.footer-section a{color:#d1d5db;text-decoration:none;font-size:.9rem;line-height:1.6;}
    .footer-section a:hover{color:var(--accent-color);}
    .social-links{display:flex;gap:.5rem;margin-top:.5rem;}
    .social-links a{
      width:32px;
      height:32px;
      background:linear-gradient(135deg, var(--primary-color), var(--accent-color));
      color:#fff;
      border:2px solid var(--tile-border);
      border-radius:50%;
      display:flex;
      align-items:center;
      justify-content:center;
      transition:transform .3s;
    }
    .social-links a:hover{transform:scale(1.15);}
    .footer-bottom{text-align:center;font-size:.8rem;color:#9ca3af;margin-top:1rem;padding-top:1rem;border-top:1px solid #555;}
    
    /* Mobile Styles */
    @media (max-width: 768px) {
      .container {padding: 0 15px;}
      .nav-links {position: fixed;top: 70px;left: -100%;width: 100%;height: calc(100vh - 70px);background: var(--primary-color);flex-direction: column;justify-content: flex-start;align-items: center;padding-top: 2rem;transition: left 0.3s ease;gap: 1rem;}
      .nav-links.active {left: 0;}
      .nav-links li {width: 100%;text-align: center;}
      .nav-links a {display: block;padding: 1rem;font-size: 1.1rem;}
      .mobile-menu {display: block;}
      .cta-button {display: none;}
      .hero {padding: 120px 0 60px;}
      .hero h1 {font-size: 2rem;line-height: 1.2;}
      .hero p {font-size: 1rem;margin-bottom: 1.5rem;}
      .hero-buttons {flex-direction: column;align-items: stretch;gap: 0.75rem;max-width: 300px;margin: 0 auto;}
      section {padding: 60px 0;}
      .section-title h2 {font-size: 2rem;}
      .gallery-wrapper{grid-template-columns:1fr;gap:2rem;}
      .gallery-slide img{height:300px;}
      .gallery-description{min-height:auto;}
      .gallery-arrow.left{left:10px;}
      .gallery-arrow.right{right:10px;}
      .testimonial-carousel{padding:2rem 60px;}
      .testimonial.center{width:90%;max-width:400px;}
      .testimonial.left,.testimonial.right{display:none;}
      .about-content {grid-template-columns: 1fr;}
      .contact-content {grid-template-columns: 1fr;}
      .footer-content {grid-template-columns: 1fr;text-align: center;}
      .social-links {justify-content: center;}
    }
  </style>
</head>
<body>
  <header>
    <nav class="container">
      <ul class="nav-links">
        <li><a href="#home">Home</a></li>
        <li><a href="#services">Services</a></li>
        <li><a href="#testimonials">Testimonials</a></li>
        <li><a href="#about">About</a></li>
        <li><a href="#contact">Contact</a></li>
      </ul>
      <a href="#contact" class="cta-button">Get Quote</a>
      <div class="mobile-menu"><i class="fas fa-bars"></i></div>
    </nav>
  </header>
  
  <section class="hero" id="home">
    <div class="container">
      <img src="Logo.png" alt="Lipscomb's Custom Remodeling Logo" class="hero-logo">
      <h1>Custom Home Remodeling Experts</h1>
      <p>Transform your space with professional kitchen, bathroom, and whole-home renovations.</p>
      <p>Serving Huntsville, Alabama</p>
      <div class="hero-buttons">
        <a href="#services" class="btn-primary">Our Services</a>
        <a href="#contact" class="btn-secondary">Free Consultation</a>
      </div>
    </div>
  </section>
  
  <section class="services" id="services">
    <div class="container">
      <div class="section-title">
        <h2>Our Services</h2>
        <p>Explore our portfolio of custom remodeling projects</p>
      </div>
      <div class="gallery-wrapper">
        <div class="gallery-container">
          <div class="gallery-arrow left" onclick="changeGallery(-1)"><i class="fas fa-chevron-left"></i></div>
          <div id="gallery"></div>
          <div class="gallery-arrow right" onclick="changeGallery(1)"><i class="fas fa-chevron-right"></i></div>
        </div>
        <div class="gallery-description" id="galleryDescription">
          <h3>Premium Craftsmanship</h3>
          <p>Loading project details...</p>
        </div>
      </div>
    </div>
  </section>
  
  <section class="testimonials" id="testimonials">
    <div class="container">
      <div class="section-title">
        <h2>What Our Clients Say</h2>
        <p>Hear from satisfied homeowners</p>
      </div>
      <div class="testimonial-carousel">
        <div class="testimonial-arrow left" onclick="changeTestimonial(-1)"><i class="fas fa-chevron-left"></i></div>
        <div class="testimonial-track" id="testimonialContainer"></div>
        <div class="testimonial-arrow right" onclick="changeTestimonial(1)"><i class="fas fa-chevron-right"></i></div>
      </div>
    </div>
  </section>

  <section class="about" id="about">
    <div class="container about-content">
      <div class="about-text">
        <h2>About Lipscomb's Custom Remodeling</h2>
        <p>At Lipscomb's Custom Remodeling, we specialize in high-quality home renovations tailored to your vision.</p>
        <p>Owned and operated by Mike Lipscomb, our team brings years of experience in custom builds and remodels, ensuring craftsmanship and attention to detail.</p>
        <p>Fully insured · Licensed contractors · Satisfaction guaranteed</p>
      </div>
      <div class="about-text">
        <h2>Our Commitment</h2>
        <p>We take pride in delivering exceptional tile work and custom finishes that transform your home into a masterpiece.</p>
        <p>Every project is approached with meticulous attention to detail, ensuring the highest quality results that exceed your expectations.</p>
      </div>
    </div>
  </section>

  <section class="contact" id="contact">
    <div class="container contact-content">
      <div class="contact-info">
        <h2>Get In Touch</h2>
        <p>Ready to start your remodeling project? Request a quote today.</p>
        <div class="contact-item"><i class="fas fa-phone"></i><div><strong>Phone</strong><br><span>(256) 698-6050</span></div></div>
        <div class="contact-item"><i class="fas fa-envelope"></i><div><strong>Email</strong><br><span>lipscombscustomremodeling@gmail.com</span></div></div>
        <div class="contact-item"><i class="fas fa-map-marker-alt"></i><div><strong>Address</strong><br><span>Huntsville, Alabama</span></div></div>
      </div>
      <div class="contact-form">
        <form action="https://formspree.io/f/YOUR_NEW_FORM_ID_HERE" method="POST" id="contactForm">
          <input type="hidden" name="_subject" value="New Quote Request from Website">
          <input type="hidden" name="_captcha" value="false">
          <div class="form-group">
            <label for="fullName">Full Name</label>
            <input type="text" id="fullName" name="fullName" required>
          </div>
          <div class="form-group">
            <label for="emailAddress">Email</label>
            <input type="email" id="emailAddress" name="emailAddress" required>
          </div>
          <div class="form-group">
            <label for="serviceNeeded">Service Needed</label>
            <select id="serviceNeeded" name="serviceNeeded" required>
              <option value="">Select a service</option>
              <option value="Kitchen Remodeling">Kitchen Remodeling</option>
              <option value="Bathroom Renovations">Bathroom Renovations</option>
              <option value="Whole-Home Remodel">Whole-Home Remodel</option>
              <option value="Custom Builds">Custom Builds</option>
            </select>
          </div>
          <div class="form-group">
            <label for="projectDetails">Project Details</label>
            <textarea id="projectDetails" name="projectDetails" placeholder="Please describe your project requirements..."></textarea>
          </div>
          <button type="submit" class="btn-primary" style="width:100%">Request Quote</button>
        </form>
      </div>
    </div>
  </section>
  
  <footer>
    <div class="container footer-content">
      <div class="footer-section">
        <h3>Lipscomb's Custom Remodeling</h3>
        <p>Expert custom home remodeling and renovations tailored to your needs.</p>
        <div class="social-links">
          <a href="#"><i class="fab fa-linkedin"></i></a>
          <a href="#"><i class="fab fa-twitter"></i></a>
        </div>
      </div>
      <div class="footer-section">
        <h3>Quick Links</h3>
        <a href="#home">Home</a><br>
        <a href="#services">Services</a><br>
        <a href="#testimonials">Testimonials</a><br>
        <a href="#about">About</a><br>
        <a href="#contact">Contact</a>
      </div>
      <div class="footer-section">
        <h3>Contact Info</h3>
        <p><i class="fas fa-phone"></i> (256) 698-6050</p>
        <p><i class="fas fa-envelope"></i> lipscombscustomremodeling@gmail.com</p>
      </div>
    </div>
    <div class="footer-bottom">&copy; 2026 Lipscomb's Custom Remodeling. All rights reserved.</div>
  </footer>
  
  <script>
    // Mobile toggle
    document.querySelector('.mobile-menu').onclick = () => {
      document.querySelector('.nav-links').classList.toggle('active');
    };
   
    document.querySelectorAll('.nav-links a').forEach(link => {
      link.addEventListener('click', () => {
        document.querySelector('.nav-links').classList.remove('active');
      });
    });
   
    // Smooth scroll
    document.querySelectorAll('a[href^="#"]').forEach(a=>{
      a.addEventListener('click',e=>{
        e.preventDefault();
        document.querySelector(a.getAttribute('href')).scrollIntoView({behavior:'smooth'});
      });
    });
   
    function parseCsv(text) {
      const lines = text.split(/\r?\n/);
      const data = [];
      lines.forEach(line => {
        if (line.trim()) {
          const cols = line.split(',').map(col => col.trim().replace(/^"|"$/g, ''));
          data.push(cols);
        }
      });
      return data;
    }

    // Gallery variables
    let galleryData = [];
    let currentGalleryIndex = 0;
    let galleryInterval;

    const galleryCsvUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQyMSHiGlCcus3kKJuEduKZxCtZg5WbbWP2x5isr4Ib0HCJXuHNrZRja8zzkE3YyVKmBalgQ8ERBrgq/pub?gid=455083677&output=csv';
    const galleryContainer = document.getElementById('gallery');
    const galleryDescription = document.getElementById('galleryDescription');

    function loadGallery() {
      if (!galleryCsvUrl) {
        galleryData = [
          {img: 'https://via.placeholder.com/800x400?text=Project+1', desc: 'Beautiful custom kitchen remodel with premium tile work.'},
          {img: 'https://via.placeholder.com/800x400?text=Project+2', desc: 'Stunning bathroom renovation featuring designer tiles.'},
          {img: 'https://via.placeholder.com/800x400?text=Project+3', desc: 'Complete home transformation with expert craftsmanship.'}
        ];
        displayGallery();
      } else {
        fetch(galleryCsvUrl)
          .then(response => response.text())
          .then(text => {
            const data = parseCsv(text);
            galleryData = data.slice(1).filter(row => row[0]).map(row => ({
              img: row[0],
              desc: row[1] || 'Premium custom remodeling work.'
            }));
            displayGallery();
          })
          .catch(() => {
            galleryData = [{img: 'https://via.placeholder.com/800x400', desc: 'Error loading gallery.'}];
            displayGallery();
          });
      }
    }

    function displayGallery() {
      if (galleryData.length === 0) return;
      let html = '';
      galleryData.forEach((item, index) => {
        html += `<div class="gallery-slide ${index === 0 ? 'active' : ''}"><img src="${item.img}" alt="Project Image"></div>`;
      });
      galleryContainer.innerHTML = html;
      updateGalleryDescription();
      startGalleryRotation();
    }

    function updateGalleryDescription() {
      if (galleryData.length === 0) return;
      const current = galleryData[currentGalleryIndex];
      galleryDescription.innerHTML = `
        <h3>Project Showcase</h3>
        <p>${current.desc}</p>
      `;
    }

    function changeGallery(direction) {
      const slides = galleryContainer.querySelectorAll('.gallery-slide');
      slides[currentGalleryIndex].classList.remove('active');
      currentGalleryIndex = (currentGalleryIndex + direction + galleryData.length) % galleryData.length;
      slides[currentGalleryIndex].classList.add('active');
      updateGalleryDescription();
      resetGalleryRotation();
    }

    function startGalleryRotation() {
      galleryInterval = setInterval(() => {
        changeGallery(1);
      }, 10000); // 10 seconds
    }

    function resetGalleryRotation() {
      clearInterval(galleryInterval);
      startGalleryRotation();
    }

    // Testimonials carousel
    let testimonialData = [];
    let currentTestimonialIndex = 0;
    let testimonialInterval;

    const testimonialCsvUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQyMSHiGlCcus3kKJuEduKZxCtZg5WbbWP2x5isr4Ib0HCJXuHNrZRja8zzkE3YyVKmBalgQ8ERBrgq/pub?gid=1066538276&single=true&output=csv';
    const testimonialContainer = document.getElementById('testimonialContainer');

    function loadTestimonials() {
      if (!testimonialCsvUrl) {
        testimonialData = [
          {name: 'Tom T', desc: 'Mike transformed our outdated kitchen and it looks amazing!', stars: 5},
          {name: 'Jane D', desc: 'Excellent work on our bathroom remodel!', stars: 5},
          {name: 'Robert M', desc: 'Professional service and beautiful tile work!', stars: 5}
        ];
        displayTestimonials();
      } else {
        fetch(testimonialCsvUrl)
          .then(response => response.text())
          .then(text => {
            const data = parseCsv(text);
            testimonialData = data.slice(1).filter(row => row[0]).map(row => ({
              name: row[0] || 'Anonymous',
              desc: row[1] || '',
              stars: parseInt(row[2] || 5)
            }));
            if (testimonialData.length < 3) {
              testimonialData = [
                ...testimonialData,
                {name: 'Valued Client', desc: 'Outstanding craftsmanship!', stars: 5}
              ];
            }
            displayTestimonials();
          })
          .catch(() => {
            testimonialData = [{name: 'Client', desc: 'Error loading testimonials.', stars: 5}];
            displayTestimonials();
          });
      }
    }

    function displayTestimonials() {
      updateTestimonialDisplay();
      startTestimonialRotation();
    }

    function updateTestimonialDisplay() {
      if (testimonialData.length === 0) return;
      const total = testimonialData.length;
      const leftIndex = (currentTestimonialIndex - 1 + total) % total;
      const rightIndex = (currentTestimonialIndex + 1) % total;
      
      const positions = [
        {index: leftIndex, pos: 'left'},
        {index: currentTestimonialIndex, pos: 'center'},
        {index: rightIndex, pos: 'right'}
      ];
      
      let html = '';
      positions.forEach(({index, pos}) => {
        const t = testimonialData[index];
        const starIcons = '★'.repeat(t.stars) + '☆'.repeat(5 - t.stars);
        html += `
          <div class="testimonial ${pos}">
            <div class="stars">${starIcons}</div>
            <div class="testimonial-name">${t.name}</div>
            <div class="testimonial-desc">${t.desc}</div>
          </div>
        `;
      });
      testimonialContainer.innerHTML = html;
    }

    function changeTestimonial(direction) {
      currentTestimonialIndex = (currentTestimonialIndex + direction + testimonialData.length) % testimonialData.length;
      updateTestimonialDisplay();
      resetTestimonialRotation();
    }

    function startTestimonialRotation() {
      testimonialInterval = setInterval(() => {
        changeTestimonial(1);
      }, 8000);
    }

    function resetTestimonialRotation() {
      clearInterval(testimonialInterval);
      startTestimonialRotation();
    }

    window.onload = () => {
      loadGallery();
      loadTestimonials();
    };

    document.getElementById('contactForm').addEventListener('submit', function(e) {
      setTimeout(() => {
        alert('Thanks! Your request has been sent.');
      }, 100);
    });
  </script>
</body>
</html>